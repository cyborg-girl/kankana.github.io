<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Context-Aware QA Agent Demo</title>

<!-- CVless theme-like styling -->
<style>
  :root{
    --bg:#0d0d0d; --card:rgba(29,53,87,0.85); --accent:#4cc9f0; --muted:#bfc9d9;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:#fff;font-family:"Inter",sans-serif;}
  #particles-js{position:fixed;inset:0;z-index:-1;}
  h1{color:var(--accent); text-align:center; margin-top:24px;}
  .wrap{display:flex;flex-wrap:wrap;justify-content:center;gap:24px;padding:24px;}
  .card{background:var(--card);border-radius:16px;padding:20px;min-width:300px;max-width:480px;box-shadow:0 12px 40px rgba(0,0,0,0.6);}
  .status{margin-top:8px;color:var(--muted);}
  textarea{width:100%;height:80px;border-radius:8px;padding:8px;border:none;background:#111;color:#fff;resize:none;}
  button{margin-top:12px;padding:8px 12px;background:var(--accent);color:#0b1020;border:none;border-radius:8px;font-weight:600;cursor:pointer;}
  .answer{margin-top:12px;padding:8px;background:rgba(255,255,255,0.05);border-radius:8px;min-height:60px;white-space:pre-wrap;}
</style>

<!-- Particles.js -->
<script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
</head>
<body>

<div id="particles-js"></div>

<h1>Context-Aware QA Agent Demo</h1>
<p style="text-align:center; max-width:600px; margin:auto; color:var(--muted)">
This demo shows how the same question can produce different answers depending on whether context is provided or not. The agent uses a small model that runs fully in-browser via WebAssembly.
</p>

<div class="wrap">
  <!-- Without Context -->
  <div class="card">
    <h2>No Context</h2>
    <textarea id="questionNoContext" placeholder="Type your question here..."></textarea>
    <button id="askNoContext">Ask</button>
    <div class="status" id="statusNoContext">Model loading...</div>
    <div class="answer" id="answerNoContext">Waiting for question...</div>
  </div>

  <!-- With Context -->
  <div class="card">
    <h2>With Context</h2>
    <textarea id="contextInput" placeholder="Provide context here..."></textarea>
    <textarea id="questionWithContext" placeholder="Type your question here..."></textarea>
    <button id="askWithContext">Ask</button>
    <div class="status" id="statusWithContext">Model loading...</div>
    <div class="answer" id="answerWithContext">Waiting for question...</div>
  </div>
</div>

<script type="module">
import * as transformers from "https://cdn.jsdelivr.net/npm/@xenova/transformers@1.3.0/dist/transformers.min.js";

let qaPipeline = null;

async function loadModel() {
  try {
    document.getElementById('statusWithContext').textContent = "Loading model...";
    document.getElementById('statusNoContext').textContent = "Loading model...";
    qaPipeline = await transformers.pipeline('question-answering', 'Xenova/distilbert-base-cased-distilled-squad');
    document.getElementById('statusWithContext').textContent = "Model loaded ✅";
    document.getElementById('statusNoContext').textContent = "Model loaded ✅";
  } catch(e) {
    console.error(e);
    document.getElementById('statusWithContext').textContent = "Failed to load model.";
    document.getElementById('statusNoContext').textContent = "Failed to load model.";
  }
}

// Ask question without context
document.getElementById('askNoContext').addEventListener('click', async () => {
  const question = document.getElementById('questionNoContext').value.trim();
  if (!qaPipeline || !question) return;
  document.getElementById('answerNoContext').textContent = "Processing...";
  try {
    const output = await qaPipeline({ question, context: "" });
    document.getElementById('answerNoContext').textContent = output.answer;
  } catch(e){
    document.getElementById('answerNoContext').textContent = "Error: " + e;
  }
});

// Ask question with context
document.getElementById('askWithContext').addEventListener('click', async () => {
  const context = document.getElementById('contextInput').value.trim();
  const question = document.getElementById('questionWithContext').value.trim();
  if (!qaPipeline || !question || !context) return;
  document.getElementById('answerWithContext').textContent = "Processing...";
  try {
    const output = await qaPipeline({ question, context });
    document.getElementById('answerWithContext').textContent = output.answer;
  } catch(e){
    document.getElementById('answerWithContext').textContent = "Error: " + e;
  }
});

window.addEventListener('DOMContentLoaded', loadModel);

// Particles.js
particlesJS("particles-js", {
  particles: { number:{value:70}, color:{value:"#4cc9f0"}, shape:{type:"circle"}, opacity:{value:0.6}, size:{value:3}, line_linked:{enable:true,distance:140,color:"#4cc9f0",opacity:0.4,width:1}, move:{enable:true,speed:1}},
  interactivity:{ events:{ onhover:{ enable:true, mode:"repulse"}}}
});
</script>

</body>
</html>
