<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visual AI Agent Demo | CVless Theme</title>

<!-- Particles.js -->
<script src="https://cdn.jsdelivr.net/npm/particles.js"></script>
<!-- MediaPipe Face Detection -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/face_detection.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<style>
/* CVless Dark Theme */
:root {
  --bg:#0d1117;
  --card:#161b22;
  --accent:#4cc9f0;
  --muted:#8b949e;
}

body {
  margin:0;
  padding:0;
  font-family:'Inter', sans-serif;
  background: var(--bg);
  color:#e6edf3;
  overflow-x:hidden;
}

#particles-js {
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  z-index:-1;
}

h1 {
  text-align:center;
  margin-top:30px;
  font-size:2rem;
  color:var(--accent);
  animation: fadeInDown 1s ease-out;
}

#explanation {
  text-align:center;
  color:var(--muted);
  font-size:1.1rem;
  margin-top:10px;
  animation: fadeIn 1.2s ease-out;
}

.container {
  display:flex;
  justify-content:center;
  align-items:flex-start;
  gap:40px;
  flex-wrap:wrap;
  padding:30px 20px;
  animation: fadeInUp 1.4s ease-out;
}

.card {
  background: var(--card);
  border-radius:16px;
  padding:20px;
  box-shadow:0 8px 30px rgba(0,0,0,0.6);
  display:flex;
  flex-direction:column;
  align-items:center;
}

#cameraWrapper {
  position:relative;
  width:640px;
  height:480px;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 0 20px rgba(0,0,0,0.5);
}

video#webcam {
  width:640px;
  height:480px;
  border-radius:12px;
}

canvas {
  position:absolute;
  top:0; left:0;
  width:640px;
  height:480px;
  border-radius:12px;
}

iframe {
  width:600px;
  height:480px;
  border-radius:12px;
  border:2px solid var(--muted);
  background:#fff;
}

button {
  margin-top:15px;
  padding:12px 24px;
  font-size:16px;
  font-weight:700;
  border:none;
  border-radius:12px;
  cursor:pointer;
  background:linear-gradient(135deg,var(--accent),#1f6feb);
  color:#fff;
  transition: transform 0.2s ease, box-shadow 0.3s ease;
}
button:hover {
  transform: scale(1.05);
  box-shadow:0 0 20px rgba(76,202,240,0.6);
}

/* Animations */
@keyframes fadeInUp {
  from { opacity:0; transform:translateY(20px); }
  to { opacity:1; transform:translateY(0); }
}
@keyframes fadeInDown {
  from { opacity:0; transform:translateY(-20px); }
  to { opacity:1; transform:translateY(0); }
}
@keyframes fadeIn {
  from { opacity:0; } to { opacity:1; }
}
</style>
</head>

<body>
<div id="particles-js"></div>

<h1>Visual AI Agent Demo</h1>
<div id="explanation">Waiting for face detection...</div>

<div class="container">
  <div class="card">
    <div id="cameraWrapper">
      <video id="webcam" autoplay playsinline></video>
      <canvas id="overlay" width="640" height="480"></canvas>
    </div>
    <button id="restartButton">Restart Camera</button>
  </div>

  <div class="card">
    <iframe id="resultsFrame" src="about:blank" sandbox="allow-scripts allow-same-origin"></iframe>
  </div>
</div>

<script>
// Particles.js
particlesJS("particles-js", {
  particles: { number:{value:70}, color:{value:"#4cc9f0"}, shape:{type:"circle"}, size:{value:3}, line_linked:{enable:true,distance:140,color:"#4cc9f0"}, move:{enable:true,speed:1} },
  interactivity:{ events:{ onhover:{ enable:true, mode:"repulse" } } }
});

const video=document.getElementById('webcam');
const canvas=document.getElementById('overlay');
const ctx=canvas.getContext('2d');
const iframe=document.getElementById('resultsFrame');
const restartBtn=document.getElementById('restartButton');
const explanation=document.getElementById('explanation');

let camera=null;
let detectedOnce=false;
let pausedFrame=null;

const dsTerms=["Data science","Machine learning","Artificial intelligence","Deep learning",
"Neural networks","Big data","Statistics","Predictive analytics",
"Natural language processing","Computer vision","Reinforcement learning",
"Supervised learning","Unsupervised learning","Clustering","Regression analysis"];

function getRandomTerm(){ return dsTerms[Math.floor(Math.random()*dsTerms.length)]; }

// MediaPipe Face Detection
const faceDetection=new FaceDetection({ locateFile:(file)=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_detection/${file}`});
faceDetection.setOptions({ model:'short', minDetectionConfidence:0.5 });

faceDetection.onResults(results=>{
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.drawImage(video,0,0,canvas.width,canvas.height);

  results.detections.forEach(d=>{
    const box=d.boundingBox;
    ctx.strokeStyle='lime';
    ctx.lineWidth=3;
    ctx.strokeRect(box.xCenter-box.width/2, box.yCenter-box.height/2, box.width, box.height);
  });

  if(results.detections.length>0 && !detectedOnce){
    detectedOnce=true;
    pausedFrame=ctx.getImageData(0,0,canvas.width,canvas.height);
    stopCamera();
    runDemoSteps();
  } else if(pausedFrame){
    ctx.putImageData(pausedFrame,0,0);
  }
});

function startCamera(){
  detectedOnce=false;
  pausedFrame=null;
  explanation.textContent="Waiting for face detection...";
  camera=new Camera(video,{onFrame:async()=>{await faceDetection.send({image:video});}, width:640,height:480});
  camera.start();
}

function stopCamera(){ if(camera){camera.stop();camera=null;} }

async function runDemoSteps(){
  const term=getRandomTerm();
  explanation.textContent=`Step 1: Face detected. Pausing camera...`;
  await new Promise(r=>setTimeout(r,5000));

  explanation.textContent=`Step 2: Preparing Bing search for "${term}"...`;
  await new Promise(r=>setTimeout(r,5000));

  explanation.textContent=`Step 3: Performing Bing search...`;
  iframe.src=`https://www.bing.com/search?q=${encodeURIComponent(term)}+site:en.wikipedia.org`;
  await new Promise(r=>setTimeout(r,5000));

  explanation.textContent=`Step 4: Opening first Wikipedia entry for "${term}"...`;
  const wikiUrl=`https://en.wikipedia.org/wiki/${encodeURIComponent(term.replace(/ /g,'_'))}`;
  iframe.src=wikiUrl;
  await new Promise(r=>setTimeout(r,5000));

  explanation.textContent=`Step 5: Demo complete! You can browse the Wikipedia page in the iframe.`;
}

restartBtn.addEventListener('click', startCamera);
startCamera();
</script>
</body>
</html>
